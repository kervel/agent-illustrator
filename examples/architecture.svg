<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="-60 -60 845.5 1253">
  <style>
    :root {
    --text-1: #333333;
    --text-light: #ffffff;
    --background-dark: #333333;
    --secondary-3: #ffe0b2;
    --secondary-1: #ff9800;
    --background-light: #ffffff;
    --foreground-light: #e0e0e0;
    --foreground-dark: #1a1a1a;
    --foreground-2: #666666;
    --text-2: #666666;
    --background-2: #f5f5f5;
    --text-dark: #1a1a1a;
    --accent-3: #bbdefb;
    --text-3: #999999;
    --accent-dark: #1565c0;
    --secondary-2: #fff3e0;
    --accent-2: #e3f2fd;
    --accent-1: #2196f3;
    --accent-light: #e3f2fd;
    --status-warning: #ff9800;
    --secondary-light: #fff3e0;
    --foreground-3: #999999;
    --status-success: #4caf50;
    --foreground-1: #333333;
    --background-3: #eeeeee;
    --background-1: #ffffff;
    --status-error: #f44336;
    --secondary-dark: #e65100;
  }

  </style>
  <defs>
    <marker id="ai-arrow" viewBox="0 0 10 10" refX="1" refY="5" markerWidth="4" markerHeight="4" markerUnits="strokeWidth" orient="auto">
      <path d="M0,0 L10,5 L0,10 Z" fill="context-stroke"/>
    </marker>
  </defs>
  <g id="diagram" class="ai-container">
    <rect id="app_bg" class="ai-shape ai-rect" x="60" y="170" width="500" height="130" fill="var(--accent-light)" stroke="var(--accent-dark)" stroke-width="1" opacity="0.15"/>
    <text id="app_label" class="ai-shape ai-text" x="248.8" y="182" text-anchor="start" dominant-baseline="middle" font-size="12" fill="var(--accent-dark)">Application Layer</text>
    <rect id="async_bg" class="ai-shape ai-rect" x="120" y="320" width="380" height="100" fill="var(--accent-light)" stroke="var(--accent-dark)" stroke-width="1" opacity="0.1"/>
    <text id="async_label" class="ai-shape ai-text" x="248.8" y="332" text-anchor="start" dominant-baseline="middle" font-size="12" fill="var(--accent-dark)">Async / Real-time</text>
    <rect id="data_bg" class="ai-shape ai-rect" x="0" y="460" width="620" height="120" fill="var(--secondary-light)" stroke="var(--secondary-dark)" stroke-width="1" opacity="0.15"/>
    <text id="data_label" class="ai-shape ai-text" x="10" y="472" text-anchor="start" dominant-baseline="middle" font-size="12" fill="var(--secondary-dark)">Data Layer</text>
    <rect id="browser" class="ai-shape ai-rect" x="230" y="27" width="160" height="46" fill="var(--foreground-3)" stroke="var(--foreground-1)" stroke-width="2"/>
    <text class="ai-label" x="310" y="50" text-anchor="middle">Browser</text>
    <g id="nginx" class="ai-container">
      <rect id="nginx_body" class="ai-shape ai-rect" x="240" y="105" width="140" height="50" fill="var(--accent-light)" stroke="var(--accent-dark)" stroke-width="2"/>
      <text class="ai-label" x="310" y="130" text-anchor="middle">Nginx Gateway</text>
    </g>
    <g id="angular" class="ai-container">
      <rect id="angular_body" class="ai-shape ai-rect" x="110" y="225" width="140" height="50" fill="var(--accent-light)" stroke="var(--accent-dark)" stroke-width="2"/>
      <text class="ai-label" x="180" y="250" text-anchor="middle">Angular 21</text>
    </g>
    <g id="django" class="ai-container">
      <rect id="django_body" class="ai-shape ai-rect" x="370" y="225" width="140" height="50" fill="var(--accent-light)" stroke="var(--accent-dark)" stroke-width="2"/>
      <text class="ai-label" x="440" y="250" text-anchor="middle">Django 6 API</text>
    </g>
    <g id="celery" class="ai-container">
      <rect id="celery_body" class="ai-shape ai-rect" x="140" y="360" width="140" height="50" fill="var(--accent-light)" stroke="var(--accent-dark)" stroke-width="2"/>
      <text class="ai-label" x="210" y="385" text-anchor="middle">Celery Workers</text>
    </g>
    <g id="channels" class="ai-container">
      <rect id="channels_body" class="ai-shape ai-rect" x="340" y="360" width="140" height="50" fill="var(--accent-light)" stroke="var(--accent-dark)" stroke-width="2"/>
      <text class="ai-label" x="410" y="385" text-anchor="middle">Django Channels</text>
    </g>
    <g id="postgres" class="ai-container">
      <ellipse id="postgres_body" class="ai-shape ai-ellipse" cx="120" cy="535" rx="65" ry="27.5" fill="var(--secondary-light)" stroke="var(--secondary-dark)" stroke-width="2"/>
      <text class="ai-label" x="120" y="535" text-anchor="middle">PostgreSQL</text>
    </g>
    <g id="redis" class="ai-container">
      <ellipse id="redis_body" class="ai-shape ai-ellipse" cx="310" cy="535" rx="65" ry="27.5" fill="var(--secondary-light)" stroke="var(--secondary-dark)" stroke-width="2"/>
      <text class="ai-label" x="310" y="535" text-anchor="middle">Redis</text>
    </g>
    <g id="minio" class="ai-container">
      <ellipse id="minio_body" class="ai-shape ai-ellipse" cx="510" cy="535" rx="65" ry="27.5" fill="var(--secondary-light)" stroke="var(--secondary-dark)" stroke-width="2"/>
      <text class="ai-label" x="510" y="535" text-anchor="middle">MinIO / S3</text>
    </g>
    <g id="keycloak" class="ai-container">
      <rect id="keycloak_body" class="ai-shape ai-rect" x="615" y="108" width="130" height="44" fill="var(--foreground-3)" stroke="var(--foreground-1)" stroke-width="1"/>
      <text class="ai-label" x="680" y="130" text-anchor="middle">OAuth2 / OIDC</text>
    </g>
    <g id="sentry" class="ai-container">
      <rect id="sentry_body" class="ai-shape ai-rect" x="615" y="228" width="130" height="44" fill="var(--foreground-3)" stroke="var(--foreground-1)" stroke-width="1"/>
      <text class="ai-label" x="680" y="250" text-anchor="middle">Sentry</text>
    </g>
    <text id="postgis_label" class="ai-shape ai-text" x="93" y="573" text-anchor="start" dominant-baseline="middle" font-size="10" fill="var(--secondary-dark)">+ PostGIS</text>
    <circle id="via_pg" class="ai-shape ai-circle" cx="200" cy="420" r="0.5" fill="#f0f0f0" stroke="#333333" stroke-width="1.5" opacity="0"/>
    <circle id="via_minio" class="ai-shape ai-circle" cx="530" cy="420" r="0.5" fill="#f0f0f0" stroke="#333333" stroke-width="1.5" opacity="0"/>
  </g>
  <text id="diagram_title" class="ai-shape ai-text" x="164.20000000000002" y="10" text-anchor="start" dominant-baseline="middle" font-size="18" fill="var(--foreground-1)">fullstack-sota Architecture</text>
  <text class="ai-label" x="207.5" y="281" text-anchor="start">HTTP / WS</text>
  <text class="ai-label" x="245" y="205" text-anchor="middle">/web/</text>
  <text class="ai-label" x="375" y="205" text-anchor="middle">/fs/</text>
  <text class="ai-label" x="310" y="240" text-anchor="middle">REST API</text>
  <text class="ai-label" x="325" y="332.5" text-anchor="middle">tasks</text>
  <text class="ai-label" x="435" y="317.5" text-anchor="start">WS</text>
  <text class="ai-label" x="260" y="473.75" text-anchor="middle">broker</text>
  <text class="ai-label" x="360" y="473.75" text-anchor="middle">channel layer</text>
  <text class="ai-label" x="225.9273256566699" y="403.5870851464804" text-anchor="start">ORM</text>
  <text class="ai-label" x="540.2771616982807" y="402.43487737146404" text-anchor="start">files</text>
  <text class="ai-label" x="497.5" y="120" text-anchor="middle">OIDC</text>
  <text class="ai-label" x="562.5" y="240" text-anchor="middle">errors</text>
  <path class="ai-connection" d="M85 461 L85 281 L310 281 L310 108.2" fill="none" stroke="#333" stroke-width="2" marker-end="url(#ai-arrow)"/>
  <path class="ai-connection" d="M310 159 L310 190 L180 190 L180 213.8" fill="none" stroke="#333" stroke-width="2" marker-end="url(#ai-arrow)"/>
  <path class="ai-connection" d="M310 159 L310 190 L440 190 L440 213.8" fill="none" stroke="#333" stroke-width="2" marker-end="url(#ai-arrow)"/>
  <path class="ai-connection" d="M254 250 L358.8 250" fill="none" stroke="#333" stroke-width="2" marker-end="url(#ai-arrow)"/>
  <path class="ai-connection" d="M440 279 L440 317.5 L210 317.5 L210 348.8" fill="none" stroke="#333" stroke-width="2" marker-end="url(#ai-arrow)"/>
  <path class="ai-connection" d="M440 279 L440 317.5 L410 317.5 L410 348.8" fill="none" stroke="#333" stroke-width="2" marker-end="url(#ai-arrow)"/>
  <path class="ai-connection" d="M210 414 L210 458.75 L120 458.75 L120 496.3" fill="none" stroke="#333" stroke-width="2" marker-end="url(#ai-arrow)"/>
  <path class="ai-connection" d="M210 414 L210 458.75 L310 458.75 L310 496.3" fill="none" stroke="#333" stroke-width="2" marker-end="url(#ai-arrow)"/>
  <path class="ai-connection" d="M410 414 L410 458.75 L310 458.75 L310 496.3" fill="none" stroke="#333" stroke-width="2" marker-end="url(#ai-arrow)"/>
  <path class="ai-connection" d="M366 250 C274.5176758876339 250 231.85465131333982 387.1741702929608 200 420 S119.99999999999999 412.0176758876339 120 496.3" fill="none" stroke="#333" stroke-width="2" marker-end="url(#ai-arrow)"/>
  <path class="ai-connection" d="M514 250 C584.2692366900338 250 530.5543233965612 384.8697547429281 530 420 S510 433.23076330996616 510 496.3" fill="none" stroke="#333" stroke-width="2" marker-end="url(#ai-arrow)"/>
  <path class="ai-connection" d="M384 130 L603.8 130" fill="none" stroke="#333" stroke-width="2" marker-end="url(#ai-arrow)"/>
  <path class="ai-connection" d="M514 250 L603.8 250" fill="none" stroke="#333" stroke-width="2" marker-end="url(#ai-arrow)"/>
</svg>
