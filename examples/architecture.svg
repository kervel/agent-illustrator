<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="-60 -59 865 734">
  <style>
    /* Kapernikov Brand Stylesheet for Agent Illustrator
   Colors from kapernikov-theme.css (huisstijlgids v4)
*/

:root {
  /* Foreground colors (lines, primary visual elements) */
  --foreground-1: #484847;       /* Dark grey */
  --foreground-2: #818281;       /* Medium grey */
  --foreground-3: #bfc0c0;       /* Light grey */
  --foreground-light: #ececec;   /* Very light grey */
  --foreground-dark: #000000;    /* Black */

  /* Background colors */
  --background-1: #ffffff;       /* White */
  --background-2: #ececec;       /* Very light grey */
  --background-3: #e2d7cd;       /* Beige */
  --background-light: #ffffff;
  --background-dark: #484847;    /* Dark grey */

  /* Text colors */
  --text-1: #484847;
  --text-2: #818281;
  --text-3: #bfc0c0;
  --text-light: #ffffff;
  --text-dark: #484847;

  /* Accent colors (brand red family) */
  --accent-1: #ba2415;           /* Primary brand red */
  --accent-2: #D4734F;           /* Red light */
  --accent-3: #dd977a;           /* Red lighter */
  --accent-light: #e2d7cd;       /* Beige (warm light fill) */
  --accent-dark: #901C1D;        /* Crimson */

  /* Secondary colors (cool teal/petrol) */
  --secondary-1: #1D6E88;        /* Petrol */
  --secondary-2: #1F92A6;        /* Cyan */
  --secondary-3: #36b191;        /* Jade */
  --secondary-light: #ececec;    /* Very light grey */
  --secondary-dark: #1D6E88;     /* Petrol */

  /* Extra brand colors (not in standard token set) */
  --kpv-burgundy: #5a322b;
  --kpv-amber: #FFB31B;

  /* Status colors */
  --status-success: #1E9F49;     /* Emerald */
  --status-warning: #DD8028;     /* Tangerine */
  --status-error: #ba2415;       /* Brand red */
}

/* Typography */
.ai-label, .ai-text {
  font-family: 'Avenir LT Std', 'Avenir', 'Segoe UI', Roboto, Arial, sans-serif;
}

/* Shape defaults: rounded corners, softer stroke */
.ai-rect {
  rx: 4;
  ry: 4;
}

/* Opt-out for schematics / electronic symbols */
.schematic .ai-rect {
  rx: 0;
  ry: 0;
}

/* White labels on dark fills (adjacent sibling only) */
[fill="var(--accent-1)"] + .ai-label,
[fill="var(--accent-dark)"] + .ai-label,
[fill="var(--secondary-1)"] + .ai-label,
[fill="var(--secondary-2)"] + .ai-label,
[fill="var(--secondary-3)"] + .ai-label,
[fill="var(--secondary-dark)"] + .ai-label,
[fill="var(--foreground-1)"] + .ai-label,
[fill="var(--foreground-dark)"] + .ai-label {
  fill: var(--text-light);
}

  </style>
  <defs>
    <marker id="ai-arrow" viewBox="0 0 10 10" refX="1" refY="5" markerWidth="4" markerHeight="4" markerUnits="strokeWidth" orient="auto">
      <path d="M0,0 L10,5 L0,10 Z" fill="context-stroke"/>
    </marker>
  </defs>
  <g id="diagram" class="ai-container">
    <rect id="app_bg" class="ai-shape ai-rect" x="60" y="170" width="500" height="130" fill="var(--accent-light)" stroke="var(--accent-dark)" stroke-width="1" opacity="0.15"/>
    <text id="app_label" class="ai-shape ai-text" x="248.8" y="182" text-anchor="start" dominant-baseline="middle" font-size="12" fill="var(--accent-dark)">Application Layer</text>
    <rect id="async_bg" class="ai-shape ai-rect" x="120" y="340" width="380" height="110" fill="var(--accent-light)" stroke="var(--accent-dark)" stroke-width="1" opacity="0.1"/>
    <text id="async_label" class="ai-shape ai-text" x="367.6" y="440" text-anchor="start" dominant-baseline="middle" font-size="12" fill="var(--accent-dark)">Async / Real-time</text>
    <rect id="data_bg" class="ai-shape ai-rect" x="0" y="495" width="620" height="120" fill="var(--secondary-light)" stroke="var(--secondary-dark)" stroke-width="1" opacity="0.15"/>
    <text id="data_label" class="ai-shape ai-text" x="10" y="507" text-anchor="start" dominant-baseline="middle" font-size="12" fill="var(--secondary-dark)">Data Layer</text>
    <rect id="browser" class="ai-shape ai-rect" x="230" y="27" width="160" height="46" fill="var(--foreground-3)" stroke="var(--foreground-1)" stroke-width="2"/>
    <text class="ai-label" x="310" y="50" text-anchor="middle" dominant-baseline="middle">Browser</text>
    <g id="nginx" class="ai-container">
      <rect id="nginx_body" class="ai-shape ai-rect" x="240" y="105" width="140" height="50" fill="var(--accent-light)" stroke="var(--accent-dark)" stroke-width="2"/>
      <text class="ai-label" x="310" y="130" text-anchor="middle" dominant-baseline="middle">Nginx Gateway</text>
    </g>
    <g id="angular" class="ai-container">
      <rect id="angular_body" class="ai-shape ai-rect" x="110" y="225" width="140" height="50" fill="var(--accent-light)" stroke="var(--accent-dark)" stroke-width="2"/>
      <text class="ai-label" x="180" y="250" text-anchor="middle" dominant-baseline="middle">Angular 21</text>
    </g>
    <g id="django" class="ai-container">
      <rect id="django_body" class="ai-shape ai-rect" x="370" y="225" width="140" height="50" fill="var(--accent-light)" stroke="var(--accent-dark)" stroke-width="2"/>
      <text class="ai-label" x="440" y="250" text-anchor="middle" dominant-baseline="middle">Django 6 API</text>
    </g>
    <g id="celery" class="ai-container">
      <rect id="celery_body" class="ai-shape ai-rect" x="140" y="387" width="140" height="50" fill="var(--accent-light)" stroke="var(--accent-dark)" stroke-width="2"/>
      <text class="ai-label" x="210" y="412" text-anchor="middle" dominant-baseline="middle">Celery Workers</text>
    </g>
    <g id="channels" class="ai-container">
      <rect id="channels_body" class="ai-shape ai-rect" x="340" y="387" width="140" height="50" fill="var(--accent-light)" stroke="var(--accent-dark)" stroke-width="2"/>
      <text class="ai-label" x="410" y="412" text-anchor="middle" dominant-baseline="middle">Django Channels</text>
    </g>
    <g id="postgres" class="ai-container">
      <ellipse id="postgres_body" class="ai-shape ai-ellipse" cx="120" cy="570" rx="65" ry="27.5" fill="var(--secondary-light)" stroke="var(--secondary-dark)" stroke-width="2"/>
      <text class="ai-label" x="120" y="570" text-anchor="middle" dominant-baseline="middle">PostgreSQL</text>
    </g>
    <g id="redis" class="ai-container">
      <ellipse id="redis_body" class="ai-shape ai-ellipse" cx="310" cy="570" rx="65" ry="27.5" fill="var(--secondary-light)" stroke="var(--secondary-dark)" stroke-width="2"/>
      <text class="ai-label" x="310" y="570" text-anchor="middle" dominant-baseline="middle">Redis</text>
    </g>
    <g id="minio" class="ai-container">
      <ellipse id="minio_body" class="ai-shape ai-ellipse" cx="510" cy="570" rx="65" ry="27.5" fill="var(--secondary-light)" stroke="var(--secondary-dark)" stroke-width="2"/>
      <text class="ai-label" x="510" y="570" text-anchor="middle" dominant-baseline="middle">MinIO / S3</text>
    </g>
    <g id="keycloak" class="ai-container">
      <rect id="keycloak_body" class="ai-shape ai-rect" x="615" y="108" width="130" height="44" fill="var(--foreground-3)" stroke="var(--foreground-1)" stroke-width="1"/>
      <text class="ai-label" x="680" y="130" text-anchor="middle" dominant-baseline="middle">OAuth2 / OIDC</text>
    </g>
    <g id="sentry" class="ai-container">
      <rect id="sentry_body" class="ai-shape ai-rect" x="615" y="228" width="130" height="44" fill="var(--foreground-3)" stroke="var(--foreground-1)" stroke-width="1"/>
      <text class="ai-label" x="680" y="250" text-anchor="middle" dominant-baseline="middle">Sentry</text>
    </g>
    <text id="postgis_label" class="ai-shape ai-text" x="93" y="608" text-anchor="start" dominant-baseline="middle" font-size="10" fill="var(--secondary-dark)">+ PostGIS</text>
    <circle id="via_pg" class="ai-shape ai-circle" cx="95" cy="440" r="0.5" fill="#f0f0f0" stroke="#333333" stroke-width="1.5" opacity="0"/>
    <circle id="via_minio" class="ai-shape ai-circle" cx="545" cy="440" r="0.5" fill="#f0f0f0" stroke="#333333" stroke-width="1.5" opacity="0"/>
  </g>
  <text id="diagram_title" class="ai-shape ai-text" x="164.20000000000002" y="10" text-anchor="start" dominant-baseline="middle" font-size="18" fill="var(--foreground-1)">fullstack-sota Architecture</text>
  <text class="ai-label" x="320" y="87" text-anchor="start" dominant-baseline="middle" fill="var(--text-2)" font-size="12">HTTP / WS</text>
  <text class="ai-label" x="247.31957707900162" y="199.7272587183939" text-anchor="middle" dominant-baseline="middle" fill="var(--text-2)" font-size="12">/web/</text>
  <text class="ai-label" x="377.31957707900165" y="180.2727412816061" text-anchor="middle" dominant-baseline="middle" fill="var(--text-2)" font-size="12">/fs/</text>
  <text class="ai-label" x="310" y="240" text-anchor="middle" dominant-baseline="middle" fill="var(--text-2)" font-size="12">REST API</text>
  <text class="ai-label" x="327.2052118944257" y="340.7538218407291" text-anchor="middle" dominant-baseline="middle" fill="var(--text-2)" font-size="12">tasks</text>
  <text class="ai-label" x="433.661855860486" y="335.9972245348958" text-anchor="start" dominant-baseline="middle" fill="var(--text-2)" font-size="12">WS</text>
  <text class="ai-label" x="264.3820224719101" y="480.7612359550562" text-anchor="middle" dominant-baseline="middle" fill="var(--text-2)" font-size="12">broker</text>
  <text class="ai-label" x="364.3820224719101" y="498.7387640449438" text-anchor="middle" dominant-baseline="middle" fill="var(--text-2)" font-size="12">channel layer</text>
  <text class="ai-label" x="131.93772715550904" y="322.72951528676026" text-anchor="middle" dominant-baseline="middle" fill="var(--text-2)" font-size="12">ORM</text>
  <text class="ai-label" x="566.982820432842" y="369.7883204673355" text-anchor="start" dominant-baseline="middle" fill="var(--text-2)" font-size="12">files</text>
  <text class="ai-label" x="497.5" y="120" text-anchor="middle" dominant-baseline="middle" fill="var(--text-2)" font-size="12">OIDC</text>
  <text class="ai-label" x="562.5" y="240" text-anchor="middle" dominant-baseline="middle" fill="var(--text-2)" font-size="12">errors</text>
  <path class="ai-connection" d="M310 73 L310 93.8" fill="none" stroke="#333" stroke-width="2" marker-end="url(#ai-arrow)"/>
  <path class="ai-connection" d="M310 159 L310 190 L180 190 L180 213.8" fill="none" stroke="#333" stroke-width="2" marker-end="url(#ai-arrow)"/>
  <path class="ai-connection" d="M310 159 L310 190 L440 190 L440 213.8" fill="none" stroke="#333" stroke-width="2" marker-end="url(#ai-arrow)"/>
  <path class="ai-connection" d="M254 250 L358.8 250" fill="none" stroke="#333" stroke-width="2" marker-end="url(#ai-arrow)"/>
  <path class="ai-connection" d="M440 279 L440 331 L210 331 L210 375.8" fill="none" stroke="#333" stroke-width="2" marker-end="url(#ai-arrow)"/>
  <path class="ai-connection" d="M440 279 L440 331 L410 331 L410 375.8" fill="none" stroke="#333" stroke-width="2" marker-end="url(#ai-arrow)"/>
  <path class="ai-connection" d="M210 441 L210 489.75 L120 489.75 L120 531.3" fill="none" stroke="#333" stroke-width="2" marker-end="url(#ai-arrow)"/>
  <path class="ai-connection" d="M210 441 L210 489.75 L310 489.75 L310 531.3" fill="none" stroke="#333" stroke-width="2" marker-end="url(#ai-arrow)"/>
  <path class="ai-connection" d="M410 441 L410 489.75 L310 489.75 L310 531.3" fill="none" stroke="#333" stroke-width="2" marker-end="url(#ai-arrow)"/>
  <path class="ai-connection" d="M366 250 C255.67673761974663 250 95.52046453281372 329.6779653065975 95 440 C94.84019324447442 473.8739824057212 120 504.62564063746413 120 531.3" fill="none" stroke="#333" stroke-width="2" marker-end="url(#ai-arrow)"/>
  <path class="ai-connection" d="M514 250 C578.1707790889973 250 555.5920040007601 376.70941349507996 545 440 C539.2485809840525 474.36655449986057 510 503.65550418087685 510 531.3" fill="none" stroke="#333" stroke-width="2" marker-end="url(#ai-arrow)"/>
  <path class="ai-connection" d="M384 130 L603.8 130" fill="none" stroke="#333" stroke-width="2" marker-end="url(#ai-arrow)"/>
  <path class="ai-connection" d="M514 250 L603.8 250" fill="none" stroke="#333" stroke-width="2" marker-end="url(#ai-arrow)"/>
</svg>
