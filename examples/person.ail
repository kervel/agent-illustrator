// Template-based person icon with hair and U-shaped torso.
// Added anchors for connections.
template "person" {
  col [gap: 6] {
    stack head_stack {
      circle head [size: 18, fill: #f2c9a0, stroke: #333, stroke_width: 1]
      path hair [fill: #2b1b0e] {
        vertex a [x: 0, y: 6]
        arc_to b [x: 18, y: 6, radius: 9]
        line_to c [x: 18, y: 6]
        line_to d [x: 13, y: 4]
        line_to e [x: 9, y: 6]
        line_to f [x: 6, y: 5]
        line_to g [x: 0, y: 6]
        close
      }
    }
    path torso [fill: #4a6fa5, stroke: #333, stroke_width: 1] {
      vertex a [x: 0, y: 6]
      arc_to b [x: 26, y: 6, radius: 13]
      line_to c [x: 26, y: 14]
      line_to d [x: 0, y: 14]
      close
    }
    path collar [fill: #ffffff, stroke: none] {
      vertex a [x: 11, y: 6]
      arc_to b [x: 17, y: 6, radius: 14]
      line_to c [x: 14, y: 12]
      close
    }
  }
  constrain head.center_x = torso.center_x
  constrain hair.center_x = head.center_x
  constrain hair.top = head.top
  constrain head.bottom = torso.top
  constrain collar.center_x = torso.center_x
  constrain collar.top = torso.top

  // Custom anchors (with small offset for spacing)
  anchor crown [position: head.top - 4, direction: up]
  anchor feet [position: torso.bottom + 4, direction: down]
  anchor hand_left [position: torso.left, direction: left]
  anchor hand_right [position: torso.right, direction: right]
}

person alice
person bob

constrain bob.left = alice.right + 80
constrain bob.vertical_center = alice.vertical_center

// Via points for S-curves
circle bottom_via [size: 1, fill: none, stroke: none]
circle top_via [size: 1, fill: none, stroke: none]

constrain bottom_via.center_x = midpoint(alice, bob)
constrain bottom_via.center_y = alice.bottom + 30

constrain top_via.center_x = midpoint(alice, bob)
constrain top_via.center_y = alice.top - 30

// S-curved connections between people
alice.feet -> bob.feet [stroke: #e65100, stroke_width: 2, routing: curved, via: bottom_via, label: "request"]
bob.crown -> alice.crown [stroke: #1565c0, stroke_width: 2, routing: curved, via: top_via, label: "response"]
